version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm install --cache .npm --loglevel=error --progress=false
        - |
          echo "Creating amplify_outputs.json for build..."
          cat > amplify_outputs.json << 'EOF'
          {
            "auth": {
              "user_pool_id": "us-east-1_K9Aawenib",
              "aws_region": "us-east-1",
              "user_pool_client_id": "42vc2al3auh1uel0ce0lsmrd3h",
              "identity_pool_id": "us-east-1:856b96bc-3133-466f-a348-d17ee032bc07",
              "mfa_methods": [],
              "standard_required_attributes": ["email", "given_name", "family_name"],
              "username_attributes": ["email"],
              "user_verification_types": ["email"],
              "mfa_configuration": "NONE",
              "password_policy": {
                "min_length": 8,
                "require_lowercase": true,
                "require_numbers": true,
                "require_symbols": true,
                "require_uppercase": true
              },
              "unauthenticated_identities_enabled": true
            },
            "data": {
              "url": "https://rx6ugeeml5gujcqfdx6jekw44u.appsync-api.us-east-1.amazonaws.com/graphql",
              "aws_region": "us-east-1",
              "api_key": "da2-r74eunjzvnazlfixbs5xchzng4",
              "default_authorization_type": "AMAZON_COGNITO_USER_POOLS",
              "authorization_types": ["API_KEY", "AWS_IAM"]
            },
            "version": "1.3"
          }
          EOF
    build:
      commands:
        - echo "Starting Next.js build..."
        - CI=false NODE_ENV=production npm run build
        - echo "Build completed successfully"
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - .next/cache/**/*
      - .npm/**/*
      - node_modules/**/*