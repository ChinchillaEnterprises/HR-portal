version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm ci
        - echo "Creating amplify_outputs.json for build..."
        - |
          cat > amplify_outputs.json << 'AMPEOF'
          {
            "auth": {
              "user_pool_id": "PLACEHOLDER",
              "aws_region": "us-east-1",
              "user_pool_client_id": "PLACEHOLDER",
              "identity_pool_id": "PLACEHOLDER",
              "mfa_methods": [],
              "standard_required_attributes": ["email"],
              "username_attributes": ["email"],
              "user_verification_types": ["email"],
              "mfa_configuration": "NONE",
              "password_policy": {
                "min_length": 8,
                "require_lowercase": true,
                "require_numbers": true,
                "require_symbols": true,
                "require_uppercase": true
              },
              "unauthenticated_identities_enabled": true
            },
            "data": {
              "url": "PLACEHOLDER",
              "aws_region": "us-east-1",
              "default_authorization_type": "AWS_IAM",
              "authorization_types": ["AMAZON_COGNITO_USER_POOLS"],
              "model_introspection": {
                "version": 1,
                "models": {},
                "enums": {},
                "queries": {},
                "mutations": {},
                "subscriptions": {}
              }
            },
            "version": "1.2"
          }
          AMPEOF
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
EOF < /dev/null